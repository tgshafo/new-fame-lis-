// –î–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –∞–≤–∞—Ç–∞—Ä–∫–∞–º–∏
const members = [
    {
        id: 1,
        nickname: "SemerkIn",
        username: "@semerkIn",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ì–ª–∞–≤–Ω–∞—è –ú–µ–¥–∏–π–∫–∞",
        description: "semerkIn - –¢–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ '–°–µ–º–µ—Ä–∫–∏–Ω'. –ü–æ—è–≤–∏–ª—Å—è –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –≤ 2020 –≥–æ–¥—É. –°–æ–∑–¥–∞—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ '–ü—Ä–∞–≤–¥–∞ –æ –∫–º'. –ü—Ä–∏–æ–±—Ä–µ–ª –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–µ—Ä–∏–∏ –∏–Ω—Ç–µ—Ä–≤—å—é —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –º–µ–¥–∏–π–Ω—ã–º–∏ –ª–∏—á–Ω–æ—Å—Ç—è–º–∏.",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar1.png",
        verified: true,
        pinned: true,
        project: "https://t.me/+xm9o_NoMxjVjNjgy",
        details: "–ò–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –ø–æ–∑–∏—Ü–∏–µ–π –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –≤–∑–≥–ª—è–¥–æ–º –Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ."
    },
    {
        id: 2,
        nickname: "Jemon",
        username: "@jemon",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ú–µ–¥–∏–π–∫–∞",
        description: "–í–ª–∞–¥–µ–ª–µ—Ü —Å–∞–π—Ç–∞, –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–∏—Å–∞—Ç—å –º–Ω–µ –∏ —Ç–¥ —Ö–∑ —Å–∞–π—Ç –≥–æ–≤–Ω–æ",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar2.png",
        verified: false,
        pinned: false,
        project: "#"
    },
    {
        id: 3,
        nickname: "–ò—Å–Ω—è–ª—Ü–µ–ø–∏",
        username: "@isnialcepi",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ú–µ–¥–∏–π–∫–∞",
        description: "–î–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ—è–≤–∏–ª–∞—Å—å –≤ 24, –Ω–∞–±—Ä–∞–ª –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞—Å—Ç–∞–º –∏ —Å–Ω–æ—Å–∞–º...",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar3.png",
        verified: false,
        pinned: false,
        project: "#"
    },
    // –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 497 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
    // {
    //     id: 4,
    //     nickname: "–£—á–∞—Å—Ç–Ω–∏–∫4",
    //     username: "@username4",
    //     category: "–§–µ–π–º",
    //     role: "–í—ã—Å–æ–∫–∏–π —Ñ–µ–π–º",
    //     description: "–û–ø–∏—Å–∞–Ω–∏–µ...",
    //     avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar4.png",
    //     verified: false,
    //     pinned: false,
    //     project: "#"
    // },
    // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–æ avatar500.png
];

// –¢–µ–∫—É—â–∏–π —Ü–≤–µ—Ç —Ç–µ–º—ã
let currentTheme = 'dark';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', function() {
    initNavigation();
    initMembers();
    initSnow();
    initSettings();
    initModals();
    loadSavedSettings();
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    applyNeonFlow();
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function initNavigation() {
    // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
    const menuToggle = document.getElementById('menu-toggle');
    const closeMenu = document.getElementById('close-menu');
    const sideMenu = document.getElementById('side-menu');
    
    if (menuToggle) {
        menuToggle.addEventListener('click', () => {
            sideMenu.classList.add('active');
        });
    }
    
    if (closeMenu) {
        closeMenu.addEventListener('click', () => {
            sideMenu.classList.remove('active');
        });
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ –Ω–∞–≤–∏–≥–∞—Ü–∏—é
    const navTabs = document.querySelectorAll('.nav-tab');
    const menuItems = document.querySelectorAll('.menu-item');
    const sections = document.querySelectorAll('.section');
    
    function switchSection(sectionId) {
        // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
        sections.forEach(section => {
            section.classList.remove('active-section');
        });
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.add('active-section');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏
        navTabs.forEach(tab => {
            tab.classList.remove('active');
            if (tab.dataset.section === sectionId) {
                tab.classList.add('active');
            }
        });
        
        menuItems.forEach(item => {
            item.classList.remove('active');
            if (item.dataset.section === sectionId) {
                item.classList.add('active');
            }
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫
    navTabs.forEach(tab => {
        if (tab.dataset.section) {
            tab.addEventListener('click', () => {
                switchSection(tab.dataset.section);
            });
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–µ–Ω—é
    menuItems.forEach(item => {
        if (item.dataset.section) {
            item.addEventListener('click', () => {
                switchSection(item.dataset.section);
                sideMenu.classList.remove('active');
            });
        }
    });
    
    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
    const faqBtn = document.getElementById('faq-btn');
    const settingsBtn = document.getElementById('settings-btn');
    const menuSettings = document.getElementById('menu-settings');
    
    if (faqBtn) {
        faqBtn.addEventListener('click', () => {
            switchSection('faq-section');
        });
    }
    
    if (settingsBtn) {
        settingsBtn.addEventListener('click', () => {
            openModal('settings-modal');
        });
    }
    
    if (menuSettings) {
        menuSettings.addEventListener('click', () => {
            openModal('settings-modal');
            sideMenu.classList.remove('active');
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function initMembers() {
    loadMembers();
    
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const category = this.dataset.category;
            filterMembers(category);
        });
    });
    
    // –ü–æ–∏—Å–∫
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            searchMembers(searchTerm);
        });
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function loadMembers() {
    const container = document.getElementById('members-container');
    if (!container) return;
    
    container.innerHTML = '';
    
    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: —Å–Ω–∞—á–∞–ª–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ, –ø–æ—Ç–æ–º –ø–æ —É—Ä–æ–≤–Ω—é —Ñ–µ–π–º–∞
    const sortedMembers = [...members].sort((a, b) => {
        if (a.pinned && !b.pinned) return -1;
        if (!a.pinned && b.pinned) return 1;
        if (a.category === '–ú–µ–¥–∏–π–∫–∏' && b.category !== '–ú–µ–¥–∏–π–∫–∏') return -1;
        if (a.category !== '–ú–µ–¥–∏–π–∫–∏' && b.category === '–ú–µ–¥–∏–π–∫–∏') return 1;
        return 0;
    });
    
    sortedMembers.forEach(member => {
        const card = createMemberCard(member);
        container.appendChild(card);
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤
    document.querySelectorAll('.member-card').forEach(card => {
        card.addEventListener('click', function() {
            const memberId = this.dataset.id;
            showProfile(memberId);
        });
    });
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
    applyNeonFlowToCards();
}

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞
function createMemberCard(member) {
    const card = document.createElement('div');
    card.className = 'member-card';
    card.dataset.id = member.id;
    card.dataset.category = member.category;
    
    if (member.pinned) card.classList.add('pinned');
    if (member.verified) card.classList.add('verified');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏
    const hasAvatar = member.avatar && member.avatar.includes('avatar');
    const avatarUrl = hasAvatar ? member.avatar : 'https://via.placeholder.com/70/2a2a2a/888?text=' + member.nickname.charAt(0);
    
    card.innerHTML = `
        <div class="member-avatar">
            <img src="${avatarUrl}" alt="${member.nickname}" onerror="this.src='https://via.placeholder.com/70/2a2a2a/888?text=Error'">
        </div>
        
        <div class="member-info">
            <h3>${member.nickname}</h3>
            <div class="member-role">${member.role}</div>
            <p class="member-description">${member.description}</p>
        </div>
    `;
    
    return card;
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function filterMembers(category) {
    const cards = document.querySelectorAll('.member-card');
    
    cards.forEach(card => {
        if (category === 'all' || card.dataset.category === category) {
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
            }, 10);
        } else {
            card.style.opacity = '0';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
}

// –ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function searchMembers(term) {
    const cards = document.querySelectorAll('.member-card');
    const activeFilter = document.querySelector('.filter-btn.active').dataset.category;
    
    cards.forEach(card => {
        const nickname = card.querySelector('h3').textContent.toLowerCase();
        const description = card.querySelector('.member-description').textContent.toLowerCase();
        
        const matchesSearch = nickname.includes(term) || description.includes(term);
        const matchesFilter = activeFilter === 'all' || card.dataset.category === activeFilter;
        
        if (matchesSearch && matchesFilter) {
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
            }, 10);
        } else {
            card.style.opacity = '0';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
}

// –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–∞
function showProfile(memberId) {
    const member = members.find(m => m.id == memberId);
    if (!member) return;
    
    const container = document.getElementById('profile-content');
    const hasAvatar = member.avatar && member.avatar.includes('avatar');
    const avatarUrl = hasAvatar ? member.avatar : 'https://via.placeholder.com/120/2a2a2a/888?text=' + member.nickname.charAt(0);
    
    // –ö–æ–ø–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–µ–π–º –ª–∏—Å—Ç
    function copyProfileLink() {
        const link = `https://t.me/+UO-WJgp_j65iYjA6`;
        navigator.clipboard.writeText(link).then(() => {
            alert('–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
        });
    }
    
    container.innerHTML = `
        <div class="profile-header">
            <div class="profile-avatar">
                <img src="${avatarUrl}" alt="${member.nickname}" onerror="this.src='https://via.placeholder.com/120/2a2a2a/888?text=Error'">
            </div>
            
            <h1 class="profile-title">${member.nickname}</h1>
            
            <div class="profile-badges">
                ${member.verified ? '<span class="badge verified">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>' : ''}
                ${member.pinned ? '<span class="badge pinned">üìå –ó–∞–∫—Ä–µ–ø–ª—ë–Ω</span>' : ''}
            </div>
            
            <p>${member.username}</p>
            
            <div class="profile-actions">
                <a href="${member.project}" class="action-btn" target="_blank">
                    <i class="fas fa-external-link-alt"></i> –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                </a>
                <a href="${member.username.replace('@', 'https://t.me/')}" class="action-btn" target="_blank">
                    <i class="fas fa-paper-plane"></i> –ù–∞–ø–∏—Å–∞—Ç—å –≤ –õ–°
                </a>
                <button class="action-btn" onclick="copyProfileLink()">
                    <i class="fas fa-share"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                </button>
            </div>
        </div>
        
        <div class="profile-description">
            <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
            <p>${member.description}</p>
            ${member.details ? `<p>${member.details}</p>` : ''}
        </div>
    `;
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è –∫ –ø—Ä–æ—Ñ–∏–ª—é
    applyNeonFlowToProfile();
    
    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Å–µ–∫—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª—è
    switchSection('profile-details');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–Ω–µ–≥–∞
function initSnow() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    createSnowflakes();
    
    // –í–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º —Å–Ω–µ–≥
    const snowToggle = document.getElementById('snow-effect');
    if (snowToggle) {
        snowToggle.addEventListener('change', function() {
            if (this.checked) {
                snowContainer.style.display = 'block';
                createSnowflakes();
            } else {
                snowContainer.style.display = 'none';
                snowContainer.innerHTML = '';
            }
        });
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–µ–∂–∏–Ω–æ–∫
function createSnowflakes() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    snowContainer.innerHTML = '';
    
    for (let i = 0; i < 60; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        const size = Math.random() * 4 + 2;
        const startX = Math.random() * 100;
        const duration = Math.random() * 5 + 5;
        const opacity = Math.random() * 0.5 + 0.3;
        
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${startX}vw`;
        snowflake.style.opacity = opacity;
        snowflake.style.animationDuration = `${duration}s`;
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        snowflake.style.backgroundColor = `rgba(255, 255, 255, ${opacity})`;
        
        snowContainer.appendChild(snowflake);
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
function initSettings() {
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    const settingsTabs = document.querySelectorAll('.settings-tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    settingsTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.dataset.tab + '-tab';
            
            settingsTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
        });
    });
    
    // –í—ã–±–æ—Ä —Ç–µ–º—ã
    const themeOptions = document.querySelectorAll('.theme-option');
    
    themeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const theme = this.dataset.theme;
            
            themeOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            applyTheme(theme);
        });
    });
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–∞
    const bgUpload = document.getElementById('bg-upload');
    const bgPreview = document.getElementById('bg-preview');
    
    if (bgUpload) {
        bgUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    bgPreview.innerHTML = `<img src="${e.target.result}" alt="–§–æ–Ω">`;
                    bgPreview.style.display = 'block';
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ–Ω
                    localStorage.setItem('fame_background', e.target.result);
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ–Ω –∫ body
                    document.body.style.backgroundImage = `url(${e.target.result})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundAttachment = 'fixed';
                    document.body.style.backgroundPosition = 'center';
                };
                reader.readAsDataURL(file);
            }
        });
    }
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
    const neonFlowEffect = document.getElementById('neon-flow-effect');
    if (neonFlowEffect) {
        neonFlowEffect.addEventListener('change', function() {
            if (this.checked) {
                applyNeonFlow();
            } else {
                removeNeonFlow();
            }
        });
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
function applyTheme(theme) {
    currentTheme = theme;
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ç–µ–º
    const themeClasses = ['dark-theme', 'black-theme', 'red-theme', 'red-black-theme', 
                         'red-gray-theme', 'purple-theme', 'blue-theme', 'green-theme', 
                         'orange-theme', 'pink-theme'];
    
    document.body.classList.remove(...themeClasses);
    document.body.classList.add(theme + '-theme');
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –≤ localStorage
    localStorage.setItem('fame_theme', theme);
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
function applyNeonFlow() {
    // –ö–∞—Ä—Ç–æ—á–∫–∏
    document.querySelectorAll('.member-card').forEach(card => {
        card.classList.add('neon-flow');
    });
    
    // –ü—Ä–æ—Ñ–∏–ª—å
    const profileHeader = document.querySelector('.profile-header');
    if (profileHeader) {
        profileHeader.classList.add('neon-flow');
    }
    
    // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    document.querySelectorAll('.modal-content').forEach(modal => {
        modal.classList.add('neon-flow');
    });
    
    // –ö–Ω–æ–ø–∫–∏
    document.querySelectorAll('.upload-btn').forEach(btn => {
        btn.classList.add('neon-flow');
    });
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
    localStorage.setItem('fame_neon_flow', 'enabled');
}

// –£–¥–∞–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
function removeNeonFlow() {
    // –ö–∞—Ä—Ç–æ—á–∫–∏
    document.querySelectorAll('.member-card').forEach(card => {
        card.classList.remove('neon-flow');
    });
    
    // –ü—Ä–æ—Ñ–∏–ª—å
    const profileHeader = document.querySelector('.profile-header');
    if (profileHeader) {
        profileHeader.classList.remove('neon-flow');
    }
    
    // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    document.querySelectorAll('.modal-content').forEach(modal => {
        modal.classList.remove('neon-flow');
    });
    
    // –ö–Ω–æ–ø–∫–∏
    document.querySelectorAll('.upload-btn').forEach(btn => {
        btn.classList.remove('neon-flow');
    });
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É
    localStorage.setItem('fame_neon_flow', 'disabled');
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è –∫ –∫–∞—Ä—Ç–æ—á–∫–∞–º
function applyNeonFlowToCards() {
    const cards = document.querySelectorAll('.member-card');
    cards.forEach(card => {
        if (localStorage.getItem('fame_neon_flow') !== 'disabled') {
            card.classList.add('neon-flow');
        }
    });
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è –∫ –ø—Ä–æ—Ñ–∏–ª—é
function applyNeonFlowToProfile() {
    const profileHeader = document.querySelector('.profile-header');
    if (profileHeader && localStorage.getItem('fame_neon_flow') !== 'disabled') {
        profileHeader.classList.add('neon-flow');
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
function initModals() {
    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    const settingsBtns = document.querySelectorAll('#settings-btn, #menu-settings');
    
    settingsBtns.forEach(btn => {
        if (btn) {
            btn.addEventListener('click', () => {
                openModal('settings-modal');
            });
        }
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', function() {
            closeModal(this.closest('.modal'));
        });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
    window.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeModal(event.target);
        }
    });
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function closeModal(modal) {
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
function loadSavedSettings() {
    // –¢–µ–º–∞
    const savedTheme = localStorage.getItem('fame_theme');
    if (savedTheme) {
        const themeOption = document.querySelector(`.theme-option[data-theme="${savedTheme}"]`);
        if (themeOption) {
            themeOption.click();
        }
    }
    
    // –§–æ–Ω
    const savedBg = localStorage.getItem('fame_background');
    if (savedBg) {
        document.body.style.backgroundImage = `url(${savedBg})`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundAttachment = 'fixed';
        document.body.style.backgroundPosition = 'center';
    }
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
    const savedNeonFlow = localStorage.getItem('fame_neon_flow');
    const neonFlowCheckbox = document.getElementById('neon-flow-effect');
    if (neonFlowCheckbox) {
        if (savedNeonFlow === 'disabled') {
            neonFlowCheckbox.checked = false;
            removeNeonFlow();
        } else {
            neonFlowCheckbox.checked = true;
        }
    }
    
    // –°–Ω–µ–≥
    const savedSnow = localStorage.getItem('fame_snow');
    const snowCheckbox = document.getElementById('snow-effect');
    if (snowCheckbox) {
        if (savedSnow === 'disabled') {
            snowCheckbox.checked = false;
            document.querySelector('.snow-container').style.display = 'none';
        } else {
            snowCheckbox.checked = true;
        }
    }
}

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
window.copyProfileLink = function() {
    const link = `https://t.me/+UO-WJgp_j65iYjA6`;
    navigator.clipboard.writeText(link).then(() => {
        alert('–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    });
};

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
document.getElementById('snow-effect')?.addEventListener('change', function() {
    localStorage.setItem('fame_snow', this.checked ? 'enabled' : 'disabled');
});

document.getElementById('neon-flow-effect')?.addEventListener('change', function() {
    localStorage.setItem('fame_neon_flow', this.checked ? 'enabled' : 'disabled');
});