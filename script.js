// –î–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
const members = [
    {
        id: 1,
        nickname: "SemerkIn",
        username: "@semerkIn",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ì–ª–∞–≤–Ω–∞—è –ú–µ–¥–∏–π–∫–∞",
        description: "semerkIn - –¢–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ '–°–µ–º–µ—Ä–∫–∏–Ω'. –ü–æ—è–≤–∏–ª—Å—è –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –≤ 2020 –≥–æ–¥—É. –°–æ–∑–¥–∞—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ '–ü—Ä–∞–≤–¥–∞ –æ –∫–º'. –ü—Ä–∏–æ–±—Ä–µ–ª –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–µ—Ä–∏–∏ –∏–Ω—Ç–µ—Ä–≤—å—é —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –º–µ–¥–∏–π–Ω—ã–º–∏ –ª–∏—á–Ω–æ—Å—Ç—è–º–∏.",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar1.png",
        verified: true,
        pinned: true,
        project: "https://t.me/+xm9o_NoMxjVjNjgy",
        telegram: "semerkIn",
        joinDate: "2020-03-15",
        activity: "–í—ã—Å–æ–∫–∞—è",
        posts: 156,
        followers: 24500,
        details: "–ò–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–µ–π –∞–∫—Ç–∏–≤–Ω–æ–π –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –ø–æ–∑–∏—Ü–∏–µ–π –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –≤–∑–≥–ª—è–¥–æ–º –Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ.",
        skills: ["–ò–Ω—Ç–µ—Ä–≤—å—é", "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞", "–ö—Ä–∏—Ç–∏–∫–∞"],
        socials: {
            telegram: "@semerkIn",
            vk: "semerkIn",
            youtube: "semerkIn"
        }
    },
    {
        id: 2,
        nickname: "Jemon",
        username: "@jemon",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ú–µ–¥–∏–π–∫–∞",
        description: "–í–ª–∞–¥–µ–ª–µ—Ü —Å–∞–π—Ç–∞, –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–∏—Å–∞—Ç—å –º–Ω–µ –∏ —Ç–¥ —Ö–∑ —Å–∞–π—Ç –≥–æ–≤–Ω–æ",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar2.png",
        verified: false,
        pinned: false,
        project: "#",
        telegram: "jemon",
        joinDate: "2023-01-10",
        activity: "–°—Ä–µ–¥–Ω—è—è",
        posts: 45,
        followers: 8900,
        details: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞. –ó–∞–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.",
        skills: ["–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞", "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ", "–î–∏–∑–∞–π–Ω"],
        socials: {
            telegram: "@jemon",
            github: "jemon"
        }
    },
    {
        id: 3,
        nickname: "–ò—Å–Ω—è–ª—Ü–µ–ø–∏",
        username: "@isnialcepi",
        category: "–ú–µ–¥–∏–π–∫–∏",
        role: "–ú–µ–¥–∏–π–∫–∞",
        description: "–î–∞–Ω–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ—è–≤–∏–ª–∞—Å—å –≤ 24, –Ω–∞–±—Ä–∞–ª –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞—Å—Ç–∞–º –∏ —Å–Ω–æ—Å–∞–º...",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar3.png",
        verified: false,
        pinned: false,
        project: "#",
        telegram: "isnialcepi",
        joinDate: "2024-02-20",
        activity: "–í—ã—Å–æ–∫–∞—è",
        posts: 210,
        followers: 18700,
        details: "–ú–∞—Å—Ç–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—É—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –º–µ–º–æ–≤. –ò–∑–≤–µ—Å—Ç–µ–Ω —Ä–µ–∑–∫–∏–º–∏ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è–º–∏ –∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏—è–º–∏.",
        skills: ["–ú–µ–º—ã", "–ü—Ä–æ–≤–æ–∫–∞—Ü–∏–∏", "–ö–æ–Ω—Ç–µ–Ω—Ç"],
        socials: {
            telegram: "@isnialcepi",
            twitter: "isnialcepi"
        }
    },
    {
        id: 4,
        nickname: "–•–∞–∫–µ—Ä Pro",
        username: "@hackerpro",
        category: "–ö–æ–¥–µ—Ä—ã",
        role: "–°–µ–Ω—å–æ—Ä –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫",
        description: "–û–ø—ã—Ç–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å 10+ –ª–µ—Ç –æ–ø—ã—Ç–∞. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: Python, JavaScript, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar4.png",
        verified: true,
        pinned: false,
        project: "https://github.com/hackerpro",
        telegram: "hackerpro",
        joinDate: "2019-11-05",
        activity: "–í—ã—Å–æ–∫–∞—è",
        posts: 320,
        followers: 31200,
        details: "–≠–∫—Å–ø–µ—Ä—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ reverse engineering. –ü—Ä–æ–≤–æ–¥–∏—Ç –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö.",
        skills: ["Python", "JavaScript", "Security", "Reverse"],
        socials: {
            telegram: "@hackerpro",
            github: "hackerpro",
            twitter: "hackerpro"
        }
    },
    {
        id: 5,
        nickname: "–î–∏–∑–∞–π–Ω–µ—Ä Art",
        username: "@designerart",
        category: "–î–∏–∑–∞–π–Ω–µ—Ä—ã",
        role: "–ì–ª–∞–≤–Ω—ã–π –î–∏–∑–∞–π–Ω–µ—Ä",
        description: "–°–æ–∑–¥–∞—é —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∏–∑–∞–π–Ω—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. UI/UX, –±—Ä–µ–Ω–¥–∏–Ω–≥, –∞–Ω–∏–º–∞—Ü–∏—è.",
        avatar: "https://raw.githubusercontent.com/yourusername/avatars/main/avatar5.png",
        verified: true,
        pinned: true,
        project: "https://dribbble.com/designerart",
        telegram: "designerart",
        joinDate: "2021-06-15",
        activity: "–í—ã—Å–æ–∫–∞—è",
        posts: 189,
        followers: 27800,
        details: "–†–∞–±–æ—Ç–∞–ª —Å –∫—Ä—É–ø–Ω—ã–º–∏ –±—Ä–µ–Ω–¥–∞–º–∏. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–º –¥–∏–∑–∞–π–Ω–µ –∏ –∞–Ω–∏–º–∞—Ü–∏—è—Ö.",
        skills: ["UI/UX", "Figma", "After Effects", "Branding"],
        socials: {
            telegram: "@designerart",
            behance: "designerart",
            instagram: "designerart"
        }
    },
    // –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ 495 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
    // –ö–∞–∂–¥–æ–º—É –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –ø–æ–ª–µ–π: telegram, joinDate, activity, posts, followers, details, skills, socials
];

// –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
let currentTheme = 'dark';
let currentNeonColor = '#808080';
let currentNeonIntensity = 0.5;
let currentNeonSpeed = 5;
let currentAnimatedBg = 'hooks';
let currentBgSpeed = 10;
let currentBgOpacity = 0.5;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', function() {
    initNavigation();
    initMembers();
    initSnow();
    initSettings();
    initNeonControls();
    initAnimatedBg();
    initModals();
    loadSavedSettings();
    initDynamicNeon();
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º 500 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    generateMembers();
});

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 500 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function generateMembers() {
    const categories = ['–ú–µ–¥–∏–π–∫–∏', '–§–µ–π–º', '–°—Ä–µ–¥–Ω–∏–π', '–ú–∞–ª—ã–π', '–ö–æ–¥–µ—Ä—ã', '–î–∏–∑–∞–π–Ω–µ—Ä—ã', '–≠–¥–∏—Ç–æ—Ä—ã'];
    const roles = {
        '–ú–µ–¥–∏–π–∫–∏': ['–ì–ª–∞–≤–Ω–∞—è –ú–µ–¥–∏–π–∫–∞', '–ú–µ–¥–∏–π–∫–∞', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç', '–ë–ª–æ–≥–µ—Ä'],
        '–§–µ–π–º': ['–í—ã—Å–æ–∫–∏–π —Ñ–µ–π–º', '–§–µ–π–º', '–ò–∑–≤–µ—Å—Ç–Ω—ã–π', '–ü–æ–ø—É–ª—è—Ä–Ω—ã–π'],
        '–°—Ä–µ–¥–Ω–∏–π': ['–ê–∫—Ç–∏–≤–Ω—ã–π', '–£—á–∞—Å—Ç–Ω–∏–∫', '–ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–æ—Ä'],
        '–ú–∞–ª—ã–π': ['–ù–æ–≤–∏—á–æ–∫', '–£—á–∞—Å—Ç–Ω–∏–∫', '–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å'],
        '–ö–æ–¥–µ—Ä—ã': ['–°–µ–Ω—å–æ—Ä –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫', '–ú–∏–¥–ª', '–î–∂—É–Ω', '–•–∞–∫–µ—Ä'],
        '–î–∏–∑–∞–π–Ω–µ—Ä—ã': ['–ì–ª–∞–≤–Ω—ã–π –î–∏–∑–∞–π–Ω–µ—Ä', '–î–∏–∑–∞–π–Ω–µ—Ä', '–ò–ª–ª—é—Å—Ç—Ä–∞—Ç–æ—Ä'],
        '–≠–¥–∏—Ç–æ—Ä—ã': ['–í–∏–¥–µ–æ-—ç–¥–∏—Ç–æ—Ä', '–ú–æ–Ω—Ç–∞–∂—ë—Ä', '–†–µ–∂–∏—Å—Å—ë—Ä']
    };
    
    const names = [
        'Alex', 'Max', 'John', 'Mike', 'David', 'Chris', 'Tom', 'Steve',
        'Anna', 'Maria', 'Kate', 'Julia', 'Lisa', 'Emma', 'Sophia',
        'CryptoPro', 'HackMaster', 'CodeNinja', 'DesignGod', 'EditKing',
        'CyberWolf', 'DigitalGhost', 'ByteLord', 'PixelWizard', 'TechGuru'
    ];
    
    const descriptions = [
        '–ê–∫—Ç–∏–≤–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞. –ó–∞–Ω–∏–º–∞–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ–º –ø—Ä–æ–µ–∫—Ç–æ–≤.',
        '–≠–∫—Å–ø–µ—Ä—Ç –≤ —Å–≤–æ–µ–π –æ–±–ª–∞—Å—Ç–∏. –ü–æ–º–æ–≥–∞–µ—Ç –Ω–æ–≤–∏—á–∫–∞–º.',
        '–°–æ–∑–¥–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞.',
        '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç —Å –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏.',
        '–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –ª–∏—á–Ω–æ—Å—Ç—å —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º.',
        '–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π.',
        '–ú–µ–Ω—Ç–æ—Ä –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.',
        '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏.'
    ];
    
    // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤ –∏ –æ—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–≤—ã–µ 5 –ø—Ä–∏–º–µ—Ä–æ–≤
    while(members.length > 5) {
        members.pop();
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 495 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    for(let i = 6; i <= 500; i++) {
        const category = categories[Math.floor(Math.random() * categories.length)];
        const roleList = roles[category];
        const role = roleList[Math.floor(Math.random() * roleList.length)];
        const name = names[Math.floor(Math.random() * names.length)] + i;
        
        members.push({
            id: i,
            nickname: name,
            username: "@" + name.toLowerCase(),
            category: category,
            role: role,
            description: descriptions[Math.floor(Math.random() * descriptions.length)],
            avatar: `https://raw.githubusercontent.com/yourusername/avatars/main/avatar${((i-1) % 50) + 1}.png`,
            verified: Math.random() > 0.7,
            pinned: Math.random() > 0.9,
            project: "#",
            telegram: name.toLowerCase(),
            joinDate: new Date(2020 + Math.floor(Math.random() * 4), 
                              Math.floor(Math.random() * 12), 
                              Math.floor(Math.random() * 28) + 1)
                        .toISOString().split('T')[0],
            activity: ['–í—ã—Å–æ–∫–∞—è', '–°—Ä–µ–¥–Ω—è—è', '–ù–∏–∑–∫–∞—è'][Math.floor(Math.random() * 3)],
            posts: Math.floor(Math.random() * 500),
            followers: Math.floor(Math.random() * 50000),
            details: '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á–∞—Å—Ç–Ω–∏–∫–µ.',
            skills: ['–ù–∞–≤—ã–∫1', '–ù–∞–≤—ã–∫2', '–ù–∞–≤—ã–∫3'],
            socials: {
                telegram: "@" + name.toLowerCase()
            }
        });
    }
    
    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
    loadMembers();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function initNavigation() {
    // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
    const menuToggle = document.getElementById('menu-toggle');
    const closeMenu = document.getElementById('close-menu');
    const sideMenu = document.getElementById('side-menu');
    
    if (menuToggle) {
        menuToggle.addEventListener('click', () => {
            sideMenu.classList.add('active');
        });
    }
    
    if (closeMenu) {
        closeMenu.addEventListener('click', () => {
            sideMenu.classList.remove('active');
        });
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
    const navTabs = document.querySelectorAll('.nav-tab');
    const menuItems = document.querySelectorAll('.menu-item');
    const sections = document.querySelectorAll('.section');
    
    function switchSection(sectionId) {
        sections.forEach(section => {
            section.classList.remove('active-section');
        });
        
        const targetSection = document.getElementById(sectionId);
        if (targetSection) {
            targetSection.classList.add('active-section');
        }
        
        navTabs.forEach(tab => {
            tab.classList.remove('active');
            if (tab.dataset.section === sectionId) {
                tab.classList.add('active');
            }
        });
        
        menuItems.forEach(item => {
            item.classList.remove('active');
            if (item.dataset.section === sectionId) {
                item.classList.add('active');
            }
        });
    }
    
    navTabs.forEach(tab => {
        if (tab.dataset.section) {
            tab.addEventListener('click', () => {
                switchSection(tab.dataset.section);
            });
        }
    });
    
    menuItems.forEach(item => {
        if (item.dataset.section) {
            item.addEventListener('click', () => {
                switchSection(item.dataset.section);
                sideMenu.classList.remove('active');
            });
        }
    });
    
    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
    const faqBtn = document.getElementById('faq-btn');
    const settingsBtn = document.getElementById('settings-btn');
    const menuSettings = document.getElementById('menu-settings');
    const animatedBgBtn = document.getElementById('animated-bg-btn');
    const menuAnimatedBg = document.getElementById('menu-animated-bg');
    
    if (faqBtn) {
        faqBtn.addEventListener('click', () => {
            switchSection('faq-section');
        });
    }
    
    if (settingsBtn) {
        settingsBtn.addEventListener('click', () => {
            openModal('settings-modal');
        });
    }
    
    if (menuSettings) {
        menuSettings.addEventListener('click', () => {
            openModal('settings-modal');
            sideMenu.classList.remove('active');
        });
    }
    
    if (animatedBgBtn) {
        animatedBgBtn.addEventListener('click', () => {
            openModal('animated-bg-modal');
        });
    }
    
    if (menuAnimatedBg) {
        menuAnimatedBg.addEventListener('click', () => {
            openModal('animated-bg-modal');
            sideMenu.classList.remove('active');
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function initMembers() {
    loadMembers();
    
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const category = this.dataset.category;
            filterMembers(category);
        });
    });
    
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            searchMembers(searchTerm);
        });
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function loadMembers() {
    const container = document.getElementById('members-container');
    if (!container) return;
    
    container.innerHTML = '';
    
    const sortedMembers = [...members].sort((a, b) => {
        if (a.pinned && !b.pinned) return -1;
        if (!a.pinned && b.pinned) return 1;
        if (a.category === '–ú–µ–¥–∏–π–∫–∏' && b.category !== '–ú–µ–¥–∏–π–∫–∏') return -1;
        if (a.category !== '–ú–µ–¥–∏–π–∫–∏' && b.category === '–ú–µ–¥–∏–π–∫–∏') return 1;
        return 0;
    });
    
    sortedMembers.forEach(member => {
        const card = createMemberCard(member);
        container.appendChild(card);
    });
    
    document.querySelectorAll('.member-card').forEach(card => {
        card.addEventListener('click', function() {
            const memberId = this.dataset.id;
            showProfile(memberId);
        });
    });
}

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞
function createMemberCard(member) {
    const card = document.createElement('div');
    card.className = 'member-card';
    card.dataset.id = member.id;
    card.dataset.category = member.category;
    
    if (member.pinned) card.classList.add('pinned');
    if (member.verified) card.classList.add('verified');
    
    const hasAvatar = member.avatar && member.avatar.includes('avatar');
    const avatarUrl = hasAvatar ? member.avatar : `https://via.placeholder.com/70/2a2a2a/888?text=${member.nickname.charAt(0)}`;
    
    card.innerHTML = `
        <div class="member-avatar">
            <img src="${avatarUrl}" alt="${member.nickname}" onerror="this.src='https://via.placeholder.com/70/2a2a2a/888?text=Error'">
        </div>
        
        <div class="member-info">
            <h3>${member.nickname}</h3>
            <div class="member-role">${member.role}</div>
            <p class="member-description">${member.description.substring(0, 100)}${member.description.length > 100 ? '...' : ''}</p>
        </div>
    `;
    
    return card;
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function filterMembers(category) {
    const cards = document.querySelectorAll('.member-card');
    
    cards.forEach(card => {
        if (category === 'all' || card.dataset.category === category) {
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
            }, 10);
        } else {
            card.style.opacity = '0';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
}

// –ü–æ–∏—Å–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function searchMembers(term) {
    const cards = document.querySelectorAll('.member-card');
    const activeFilter = document.querySelector('.filter-btn.active').dataset.category;
    
    cards.forEach(card => {
        const nickname = card.querySelector('h3').textContent.toLowerCase();
        const description = card.querySelector('.member-description').textContent.toLowerCase();
        
        const matchesSearch = nickname.includes(term) || description.includes(term);
        const matchesFilter = activeFilter === 'all' || card.dataset.category === activeFilter;
        
        if (matchesSearch && matchesFilter) {
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
            }, 10);
        } else {
            card.style.opacity = '0';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
}

// –ü–û–õ–ù–´–ô –ü–†–û–§–ò–õ–¨ –° –í–°–ï–ô –ò–ù–§–û–†–ú–ê–¶–ò–ï–ô
function showProfile(memberId) {
    const member = members.find(m => m.id == memberId);
    if (!member) return;
    
    const container = document.getElementById('profile-content');
    const hasAvatar = member.avatar && member.avatar.includes('avatar');
    const avatarUrl = hasAvatar ? member.avatar : `https://via.placeholder.com/120/2a2a2a/888?text=${member.nickname.charAt(0)}`;
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
    const joinDate = new Date(member.joinDate);
    const formattedDate = joinDate.toLocaleDateString('ru-RU', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–π–¥–∂–µ–π –Ω–∞–≤—ã–∫–æ–≤
    const skillsHtml = member.skills ? member.skills.map(skill => 
        `<span class="badge category">${skill}</span>`
    ).join('') : '';
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
    const socialsHtml = member.socials ? Object.entries(member.socials).map(([platform, value]) => {
        let icon = 'fas fa-link';
        let url = '#';
        
        switch(platform) {
            case 'telegram':
                icon = 'fab fa-telegram';
                url = `https://t.me/${value.replace('@', '')}`;
                break;
            case 'github':
                icon = 'fab fa-github';
                url = `https://github.com/${value}`;
                break;
            case 'twitter':
                icon = 'fab fa-twitter';
                url = `https://twitter.com/${value}`;
                break;
            case 'vk':
                icon = 'fab fa-vk';
                url = `https://vk.com/${value}`;
                break;
            case 'youtube':
                icon = 'fab fa-youtube';
                url = `https://youtube.com/${value}`;
                break;
            case 'instagram':
                icon = 'fab fa-instagram';
                url = `https://instagram.com/${value}`;
                break;
            case 'behance':
                icon = 'fab fa-behance';
                url = `https://behance.net/${value}`;
                break;
        }
        
        return `<a href="${url}" class="action-btn telegram" target="_blank">
                    <i class="${icon}"></i> ${platform.charAt(0).toUpperCase() + platform.slice(1)}
                </a>`;
    }).join('') : '';
    
    container.innerHTML = `
        <div class="profile-header">
            <div class="profile-avatar">
                <img src="${avatarUrl}" alt="${member.nickname}" onerror="this.src='https://via.placeholder.com/120/2a2a2a/888?text=Error'">
            </div>
            
            <h1 class="profile-title">${member.nickname}</h1>
            <p class="profile-username">${member.username}</p>
            
            <div class="profile-badges">
                ${member.verified ? '<span class="badge verified">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>' : ''}
                ${member.pinned ? '<span class="badge pinned">üìå –ó–∞–∫—Ä–µ–ø–ª—ë–Ω</span>' : ''}
                <span class="badge category">${member.category}</span>
                ${skillsHtml}
            </div>
            
            <div class="profile-actions">
                <a href="https://t.me/${member.telegram}" class="action-btn telegram" target="_blank">
                    <i class="fab fa-telegram"></i> –ù–∞–ø–∏—Å–∞—Ç—å –≤ –õ–°
                </a>
                ${member.project !== '#' ? `<a href="${member.project}" class="action-btn" target="_blank">
                    <i class="fas fa-external-link-alt"></i> –ü—Ä–æ–µ–∫—Ç
                </a>` : ''}
                <button class="action-btn" onclick="copyProfileLink('${member.nickname}')">
                    <i class="fas fa-share"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                </button>
                ${socialsHtml}
            </div>
        </div>
        
        <div class="profile-content">
            <div class="profile-description">
                <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <p>${member.description}</p>
                ${member.details ? `<p><strong>–î–µ—Ç–∞–ª–∏:</strong> ${member.details}</p>` : ''}
                
                <h3 style="margin-top: 30px;">–ù–∞–≤—ã–∫–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</h3>
                <p>${member.skills ? member.skills.join(' ‚Ä¢ ') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                
                ${member.socials ? `
                <h3 style="margin-top: 30px;">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h3>
                <div class="profile-actions">
                    ${Object.entries(member.socials).map(([platform, value]) => {
                        let icon = 'fas fa-link';
                        let url = '#';
                        
                        switch(platform) {
                            case 'telegram':
                                icon = 'fab fa-telegram';
                                url = `https://t.me/${value.replace('@', '')}`;
                                break;
                            case 'github':
                                icon = 'fab fa-github';
                                url = `https://github.com/${value}`;
                                break;
                            case 'twitter':
                                icon = 'fab fa-twitter';
                                url = `https://twitter.com/${value}`;
                                break;
                            case 'vk':
                                icon = 'fab fa-vk';
                                url = `https://vk.com/${value}`;
                                break;
                            case 'youtube':
                                icon = 'fab fa-youtube';
                                url = `https://youtube.com/${value}`;
                                break;
                        }
                        
                        return `<a href="${url}" class="action-btn telegram" target="_blank">
                                    <i class="${icon}"></i> ${platform}
                                </a>`;
                    }).join('')}
                </div>` : ''}
            </div>
            
            <div class="profile-stats">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="stat-item">
                    <span class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
                    <span class="stat-value">${member.category}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–†–æ–ª—å:</span>
                    <span class="stat-value">${member.role}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è:</span>
                    <span class="stat-value">${formattedDate}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</span>
                    <span class="stat-value">${member.activity}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–ü—É–±–ª–∏–∫–∞—Ü–∏–∏:</span>
                    <span class="stat-value">${member.posts}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏:</span>
                    <span class="stat-value">${member.followers.toLocaleString()}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span class="stat-value">${member.verified ? '–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω ‚úì' : '–ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω'}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ID:</span>
                    <span class="stat-value">${member.id}</span>
                </div>
            </div>
        </div>
    `;
    
    switchSection('profile-details');
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–Ω–µ–≥–∞
function initSnow() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    createSnowflakes();
    
    const snowToggle = document.getElementById('snow-effect');
    if (snowToggle) {
        snowToggle.addEventListener('change', function() {
            if (this.checked) {
                snowContainer.style.display = 'block';
                createSnowflakes();
            } else {
                snowContainer.style.display = 'none';
                snowContainer.innerHTML = '';
            }
        });
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–µ–∂–∏–Ω–æ–∫
function createSnowflakes() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    snowContainer.innerHTML = '';
    
    for (let i = 0; i < 60; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        const size = Math.random() * 4 + 2;
        const startX = Math.random() * 100;
        const duration = Math.random() * 5 + 5;
        const opacity = Math.random() * 0.5 + 0.3;
        
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${startX}vw`;
        snowflake.style.opacity = opacity;
        snowflake.style.animationDuration = `${duration}s`;
        snowflake.style.animationDelay = `${Math.random() * 5}s`;
        snowflake.style.backgroundColor = `rgba(255, 255, 255, ${opacity})`;
        
        snowContainer.appendChild(snowflake);
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
function initSettings() {
    const settingsTabs = document.querySelectorAll('.settings-tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    settingsTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const tabId = this.dataset.tab + '-tab';
            
            settingsTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
        });
    });
    
    const themeOptions = document.querySelectorAll('.theme-option');
    
    themeOptions.forEach(option => {
        option.addEventListener('click', function() {
            const theme = this.dataset.theme;
            
            themeOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            
            applyTheme(theme);
        });
    });
    
    const bgUpload = document.getElementById('bg-upload');
    const bgPreview = document.getElementById('bg-preview');
    
    if (bgUpload) {
        bgUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    bgPreview.innerHTML = `<img src="${e.target.result}" alt="–§–æ–Ω">`;
                    bgPreview.style.display = 'block';
                    
                    localStorage.setItem('fame_background', e.target.result);
                    document.body.style.backgroundImage = `url(${e.target.result})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundAttachment = 'fixed';
                    document.body.style.backgroundPosition = 'center';
                };
                reader.readAsDataURL(file);
            }
        });
    }
    
    const neonFlowEffect = document.getElementById('neon-flow-effect');
    if (neonFlowEffect) {
        neonFlowEffect.addEventListener('change', function() {
            if (this.checked) {
                initDynamicNeon();
            } else {
                removeNeonFlow();
            }
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –Ω–µ–æ–Ω–∞
function initNeonControls() {
    const neonColor = document.getElementById('neon-color');
    const neonIntensity = document.getElementById('neon-intensity');
    const neonSpeed = document.getElementById('neon-speed');
    const applyNeonBtn = document.getElementById('apply-neon');
    const intensityValue = document.getElementById('intensity-value');
    const speedValue = document.getElementById('speed-value');
    const colorPreview = document.getElementById('neon-color-preview');
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ü–≤–µ—Ç–∞
    if (neonColor && colorPreview) {
        neonColor.addEventListener('input', function() {
            colorPreview.style.backgroundColor = this.value;
        });
        colorPreview.style.backgroundColor = neonColor.value;
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
    if (neonIntensity && intensityValue) {
        neonIntensity.addEventListener('input', function() {
            intensityValue.textContent = this.value + '%';
        });
        intensityValue.textContent = neonIntensity.value + '%';
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
    if (neonSpeed && speedValue) {
        const speedLabels = {
            1: '–û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ',
            2: '–ú–µ–¥–ª–µ–Ω–Ω–æ',
            3: '–ù–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–æ',
            4: '–ù–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–π',
            5: '–°—Ä–µ–¥–Ω—è—è',
            6: '–í—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π',
            7: '–ë—ã—Å—Ç—Ä–æ',
            8: '–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ',
            9: '–°—É–ø–µ—Ä –±—ã—Å—Ç—Ä–æ',
            10: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è'
        };
        
        neonSpeed.addEventListener('input', function() {
            speedValue.textContent = speedLabels[this.value] || '–°—Ä–µ–¥–Ω—è—è';
        });
        speedValue.textContent = speedLabels[neonSpeed.value] || '–°—Ä–µ–¥–Ω—è—è';
    }
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ–æ–Ω–∞
    if (applyNeonBtn) {
        applyNeonBtn.addEventListener('click', function() {
            const color = neonColor.value;
            const intensity = parseInt(neonIntensity.value) / 100;
            const speed = parseInt(neonSpeed.value);
            
            applyNeonSettings(color, intensity, speed);
        });
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ–æ–Ω–∞
function applyNeonSettings(color, intensity, speed) {
    currentNeonColor = color;
    currentNeonIntensity = intensity;
    currentNeonSpeed = speed;
    
    localStorage.setItem('fame_neon_color', color);
    localStorage.setItem('fame_neon_intensity', intensity);
    localStorage.setItem('fame_neon_speed', speed);
    
    initDynamicNeon();
}

// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –Ω–µ–æ–Ω
function initDynamicNeon() {
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Å—Ç–∏–ª–∏
    const oldStyle = document.getElementById('dynamic-neon-style');
    if (oldStyle) oldStyle.remove();
    
    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º hex –≤ rgba
    const hex = currentNeonColor;
    const r = parseInt(hex.slice(1,3), 16);
    const g = parseInt(hex.slice(3,5), 16);
    const b = parseInt(hex.slice(5,7), 16);
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
    const duration = (11 - currentNeonSpeed) + 's';
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏
    const style = document.createElement('style');
    style.id = 'dynamic-neon-style';
    
    style.textContent = `
        @keyframes neonFlow {
            0%, 100% { 
                box-shadow: 0 0 ${10 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.8 * currentNeonIntensity}),
                          0 0 ${20 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.6 * currentNeonIntensity}),
                          0 0 ${30 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.4 * currentNeonIntensity}),
                          inset 0 0 ${10 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.5 * currentNeonIntensity}); 
            }
            50% { 
                box-shadow: 0 0 ${15 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.9 * currentNeonIntensity}),
                          0 0 ${25 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.7 * currentNeonIntensity}),
                          0 0 ${35 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.5 * currentNeonIntensity}),
                          inset 0 0 ${15 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.6 * currentNeonIntensity}); 
            }
        }
        
        @keyframes textNeonFlow {
            0%, 100% { 
                text-shadow: 0 0 ${5 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.8 * currentNeonIntensity}),
                           0 0 ${10 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.6 * currentNeonIntensity}); 
            }
            50% { 
                text-shadow: 0 0 ${8 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.9 * currentNeonIntensity}),
                           0 0 ${15 * currentNeonIntensity}px rgba(${r}, ${g}, ${b}, ${0.7 * currentNeonIntensity}); 
            }
        }
        
        .neon-flow {
            animation: neonFlow ${duration} ease-in-out infinite !important;
        }
        
        .text-neon-flow {
            animation: textNeonFlow ${duration} ease-in-out infinite !important;
        }
    `;
    
    document.head.appendChild(style);
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–µ–æ–Ω –∫–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
    const neonFlowEffect = document.getElementById('neon-flow-effect');
    if (neonFlowEffect && neonFlowEffect.checked) {
        applyNeonToElements();
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–µ–æ–Ω–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º
function applyNeonToElements() {
    document.querySelectorAll('.member-card').forEach(card => {
        card.classList.add('neon-flow');
    });
    
    document.querySelectorAll('.modal-content').forEach(modal => {
        modal.classList.add('neon-flow');
    });
    
    document.querySelectorAll('.upload-btn').forEach(btn => {
        btn.classList.add('neon-flow');
    });
    
    const profileHeader = document.querySelector('.profile-header');
    if (profileHeader) {
        profileHeader.classList.add('neon-flow');
    }
}

// –£–¥–∞–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
function removeNeonFlow() {
    document.querySelectorAll('.neon-flow').forEach(el => {
        el.classList.remove('neon-flow');
    });
    document.querySelectorAll('.text-neon-flow').forEach(el => {
        el.classList.remove('text-neon-flow');
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ–Ω–∞
function initAnimatedBg() {
    const bgOptions = document.querySelectorAll('.animated-bg-option');
    const bgSpeed = document.getElementById('bg-speed');
    const bgOpacity = document.getElementById('bg-opacity');
    const applyBgBtn = document.getElementById('apply-animated-bg');
    
    // –í—ã–±–æ—Ä —Ñ–æ–Ω–∞
    bgOptions.forEach(option => {
        option.addEventListener('click', function() {
            bgOptions.forEach(opt => opt.classList.remove('active'));
            this.classList.add('active');
            currentAnimatedBg = this.dataset.bg;
        });
    });
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
    if (bgSpeed) {
        bgSpeed.addEventListener('input', function() {
            currentBgSpeed = parseInt(this.value);
        });
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏
    if (bgOpacity) {
        bgOpacity.addEventListener('input', function() {
            currentBgOpacity = parseInt(this.value) / 100;
        });
    }
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞
    if (applyBgBtn) {
        applyBgBtn.addEventListener('click', applyAnimatedBg);
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ–Ω–∞
function applyAnimatedBg() {
    const bgElement = document.getElementById('animated-bg');
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ñ–æ–Ω–æ–≤
    const bgClasses = ['particles-bg', 'waves-bg', 'pulse-bg', 'hooks-bg', 
                      'circuit-bg', 'grid-bg', 'dots-bg', 'lines-bg'];
    bgClasses.forEach(cls => bgElement.classList.remove(cls));
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–æ–Ω
    bgElement.classList.add(`${currentAnimatedBg}-bg`);
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
    const speed = currentBgSpeed / 10;
    bgElement.style.animationDuration = `${20 / speed}s`;
    
    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
    bgElement.style.opacity = currentBgOpacity;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    localStorage.setItem('fame_animated_bg', currentAnimatedBg);
    localStorage.setItem('fame_bg_speed', currentBgSpeed);
    localStorage.setItem('fame_bg_opacity', currentBgOpacity);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
function initModals() {
    const settingsBtns = document.querySelectorAll('#settings-btn, #menu-settings');
    
    settingsBtns.forEach(btn => {
        if (btn) {
            btn.addEventListener('click', () => {
                openModal('settings-modal');
            });
        }
    });
    
    document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', function() {
            closeModal(this.closest('.modal'));
        });
    });
    
    window.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeModal(event.target);
        }
    });
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function closeModal(modal) {
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
function loadSavedSettings() {
    // –¢–µ–º–∞
    const savedTheme = localStorage.getItem('fame_theme');
    if (savedTheme) {
        const themeOption = document.querySelector(`.theme-option[data-theme="${savedTheme}"]`);
        if (themeOption) {
            themeOption.click();
        }
    }
    
    // –§–æ–Ω
    const savedBg = localStorage.getItem('fame_background');
    if (savedBg) {
        document.body.style.backgroundImage = `url(${savedBg})`;
        document.body.style.backgroundSize = 'cover';
        document.body.style.backgroundAttachment = 'fixed';
        document.body.style.backgroundPosition = 'center';
    }
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ–æ–Ω–∞
    const savedNeonColor = localStorage.getItem('fame_neon_color') || '#808080';
    const savedNeonIntensity = parseFloat(localStorage.getItem('fame_neon_intensity')) || 0.5;
    const savedNeonSpeed = parseInt(localStorage.getItem('fame_neon_speed')) || 5;
    
    const neonColor = document.getElementById('neon-color');
    const neonIntensity = document.getElementById('neon-intensity');
    const neonSpeed = document.getElementById('neon-speed');
    
    if (neonColor) neonColor.value = savedNeonColor;
    if (neonIntensity) neonIntensity.value = savedNeonIntensity * 100;
    if (neonSpeed) neonSpeed.value = savedNeonSpeed;
    
    applyNeonSettings(savedNeonColor, savedNeonIntensity, savedNeonSpeed);
    
    // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω
    const savedAnimatedBg = localStorage.getItem('fame_animated_bg') || 'hooks';
    const savedBgSpeed = parseInt(localStorage.getItem('fame_bg_speed')) || 10;
    const savedBgOpacity = parseFloat(localStorage.getItem('fame_bg_opacity')) || 0.5;
    
    currentAnimatedBg = savedAnimatedBg;
    currentBgSpeed = savedBgSpeed;
    currentBgOpacity = savedBgOpacity;
    
    const bgOption = document.querySelector(`.animated-bg-option[data-bg="${savedAnimatedBg}"]`);
    if (bgOption) {
        bgOption.classList.add('active');
    }
    
    const bgSpeed = document.getElementById('bg-speed');
    const bgOpacity = document.getElementById('bg-opacity');
    
    if (bgSpeed) bgSpeed.value = savedBgSpeed;
    if (bgOpacity) bgOpacity.value = savedBgOpacity * 100;
    
    applyAnimatedBg();
    
    // –≠—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è
    const savedNeonFlow = localStorage.getItem('fame_neon_flow');
    const neonFlowCheckbox = document.getElementById('neon-flow-effect');
    if (neonFlowCheckbox) {
        if (savedNeonFlow === 'disabled') {
            neonFlowCheckbox.checked = false;
            removeNeonFlow();
        } else {
            neonFlowCheckbox.checked = true;
        }
    }
    
    // –°–Ω–µ–≥
    const savedSnow = localStorage.getItem('fame_snow');
    const snowCheckbox = document.getElementById('snow-effect');
    if (snowCheckbox) {
        if (savedSnow === 'disabled') {
            snowCheckbox.checked = false;
            document.querySelector('.snow-container').style.display = 'none';
        } else {
            snowCheckbox.checked = true;
        }
    }
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
function applyTheme(theme) {
    currentTheme = theme;
    
    const themeClasses = ['dark-theme', 'black-theme', 'red-theme', 'red-black-theme', 
                         'red-gray-theme', 'purple-theme', 'blue-theme', 'green-theme', 
                         'orange-theme', 'pink-theme'];
    
    document.body.classList.remove(...themeClasses);
    document.body.classList.add(theme + '-theme');
    
    localStorage.setItem('fame_theme', theme);
}

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
window.copyProfileLink = function(username) {
    const link = `https://t.me/+UO-WJgp_j65iYjA6?text=–°–º–æ—Ç—Ä–∏%20–ø—Ä–æ—Ñ–∏–ª—å%20${encodeURIComponent(username)}`;
    navigator.clipboard.writeText(link).then(() => {
        alert('–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
    });
};

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
document.getElementById('snow-effect')?.addEventListener('change', function() {
    localStorage.setItem('fame_snow', this.checked ? 'enabled' : 'disabled');
});

document.getElementById('neon-flow-effect')?.addEventListener('change', function() {
    localStorage.setItem('fame_neon_flow', this.checked ? 'enabled' : 'disabled');
    if (this.checked) {
        initDynamicNeon();
    } else {
        removeNeonFlow();
    }
});

// –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π
function switchSection(sectionId) {
    document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active-section');
    });
    
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.classList.add('active-section');
    }
    
    document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.section === sectionId) {
            tab.classList.add('active');
        }
    });
}